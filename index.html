<!doctype html>
<html lang="es-UY">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Cumple 6 de Victoria</title>
  <meta name="description" content="Invitaci√≥n al cumple de Victoria (6 a√±os). Confirmaci√≥n por WhatsApp." />

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600;700;800;900&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg-pink:#ffe6f2;
      --card:rgba(255,255,255,.90);
      --ink:#594a4e;
      --muted:#9c8c90;
      --hk-red:#ff3366;
      --hk-pink:#ff85b3;
      --radius:26px;
      --shadow: 0 16px 40px rgba(255, 51, 102, 0.15);
    }

    *{box-sizing:border-box}
    html,body{height:100%}

    body{
      margin:0;
      font-family:'Fredoka', sans-serif;
      color:var(--ink);
      background-color: var(--bg-pink);
      -webkit-font-smoothing: antialiased;
      overflow-x:hidden;

      background-image: url("img/fondo-kitty.jpg");
      background-repeat: repeat;
      background-size: 360px 360px;
      background-position: 0 0;
    }

    .wrap{
      max-width:480px;
      margin:0 auto;
      padding:20px 16px 24px;
    }

    .card{
      background: var(--card);
      border: 2px solid rgba(255,255,255,.95);
      backdrop-filter: blur(12px);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 20px;
      margin-bottom: 16px;
      position: relative;
      overflow: visible;
    }

    /* Todo el contenido por arriba de stickers */
    .card > *{ position:relative; z-index:2; }

    /* Stickers: al fondo y sin tapar */
    .sticker{
      position:absolute;
      width:112px;
      height:auto;
      pointer-events:none;
      user-select:none;
      filter: drop-shadow(0 10px 14px rgba(0,0,0,.10));
      opacity: .55;
      z-index:0;
    }

    /* Stickers que van POR ARRIBA del contenido */
    .sticker.front{
      z-index: 5;
      opacity: .75;
    }

    .st1{ top:-14px; right:-14px; transform: rotate(10deg); }
    .st2{ bottom:-18px; left:-14px; transform: rotate(-10deg); width:120px; }
    .st3{ top:-14px; left:10px; transform: rotate(-6deg); width:98px; }
    .st4{ bottom:-18px; right:-14px; transform: rotate(8deg); width:120px; }
    .st5{ top:-14px; right:92px; transform: rotate(-8deg); width:98px; }

    /* Kitty del mapa a la derecha, apenas asomando "cuello" */
    .mapKitty{
      right:-18px;
      top:126px;
      left:auto;
      bottom:auto;
      width:150px;
      transform: rotate(7deg);
      opacity:.42;
    }

    /* KITTY REAL (header) */
    .hk-header{
      position: relative;
      height: 118px;
      display:flex;
      justify-content:center;
      align-items:flex-end;
      margin-bottom:-38px;
      z-index:2;
      pointer-events:none;
    }
    .hk-real{
      width: 160px;
      height: 160px;
      border-radius: 999px;
      display:grid;
      place-items:center;
      background: rgba(255,255,255,.78);
      border: 2px solid rgba(255,255,255,.95);
      box-shadow: 0 16px 34px rgba(0,0,0,.12);
      backdrop-filter: blur(10px);
      transform: translateY(16px);
      overflow:hidden;
    }
    .hk-real img{
      width: 92%;
      height: 92%;
      object-fit: contain;
      display:block;
      filter: drop-shadow(0 8px 12px rgba(0,0,0,.10));
    }

    .h1{
      margin:0;
      font-size:34px;
      letter-spacing:-0.6px;
      line-height:1.05;
      font-weight:800;
      color:var(--hk-red);
      text-align:center;
      text-shadow:2px 2px 0px #fff;
    }
    .sub{
      margin:8px 0 0;
      color:var(--muted);
      font-size:16px;
      text-align:center;
      font-weight:700;
    }

    .pill{
      background:#fff;
      padding:7px 16px;
      border-radius:999px;
      color:var(--hk-red);
      font-size:13px;
      font-weight:800;
      border:2px solid var(--hk-pink);
      display:table;
      margin:12px auto 0;
      box-shadow: 0 10px 18px rgba(0,0,0,.06);
    }

    /* ====== grilla fotos (base, misma que us√°s adentro) ====== */
    .memories{
      margin-top:14px;
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap:10px;
    }
    .memory{
      position:relative;
      border-radius:18px;
      overflow:hidden;
      background: rgba(255,255,255,.65);
      border:2px solid rgba(255,255,255,.95);
      box-shadow: 0 10px 18px rgba(0,0,0,.06);
      aspect-ratio: 1 / 1;
    }
    .memory img{
      width:100%;
      height:100%;
      object-fit:cover;
      display:block;
    }
    .memory .badge{
      position:absolute;
      top:8px;
      left:8px;
      background: rgba(255,255,255,.92);
      border:2px solid rgba(255,133,179,.55);
      color: var(--hk-red);
      font-weight:900;
      font-size:12px;
      padding:4px 8px;
      border-radius:999px;
      box-shadow: 0 10px 16px rgba(0,0,0,.06);
    }

    .sectionTitle{
      margin:0 0 14px;
      color:var(--hk-red);
      font-weight:900;
      text-align:center;
      font-size:18px;
    }

    .info{
      background: rgba(255,255,255,0.78);
      border-radius:18px;
      padding:12px;
      display:flex;
      gap:12px;
      align-items:center;
      margin-bottom:10px;
      border:1px solid rgba(255,255,255,.95);
    }
    .icon{
      width:42px; height:42px; border-radius:50%;
      background:#fff; color: var(--hk-red);
      display:grid; place-items:center;
      flex:0 0 auto; font-size:20px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.05);
    }
    .info div b{display:block; font-size:14px; color: var(--hk-red); margin-bottom:2px;}
    .info div span{font-size:15px; color: var(--ink); line-height:1.2;}

    .actions{display:grid; gap:10px; margin-top:16px;}
    .btn{
      border:0; cursor:pointer; width:100%;
      padding:15px;
      border-radius:20px;
      font-weight:800; font-size:15px;
      display:inline-flex; align-items:center; justify-content:center; gap:8px;
      text-decoration:none;
      transition: transform 0.1s;
      font-family:'Fredoka', sans-serif;
    }
    .btn:active{transform: scale(0.97);}
    .btn.secondary{background:#fff; color: var(--ink); border:2px solid rgba(255,230,242,.9);}
    .btn.primary{
      background: var(--hk-red); color:#fff;
      box-shadow: 0 10px 26px rgba(255, 51, 102, 0.32);
      border: 2px solid transparent;
    }
    .backBtn{
      width:100%;
      border:2px solid rgba(255,255,255,.95);
      background: rgba(255,255,255,.88);
      color: var(--hk-red);
      font-weight:900;
      font-size:14px;
      padding:12px 14px;
      border-radius: 18px;
      box-shadow: 0 10px 18px rgba(0,0,0,.06);
      cursor:pointer;
      margin-bottom: 14px;
      display:none;
      font-family: 'Fredoka', sans-serif;
      text-align: center;
      justify-content: center;
    }
    .backBtn:active{ transform: scale(0.98); }

    /* Achicar SOLO el bot√≥n de WhatsApp */
    #btnSend{
      padding: 9px 12px;
      font-size: 13px;
      border-radius: 16px;
      line-height: 1;
      box-shadow: 0 8px 18px rgba(255, 51, 102, 0.28);
    }

    .rsvp input, .rsvp select, .rsvp textarea{
      width:100%;
      padding:14px;
      border-radius:16px;
      border:2px solid rgba(255,230,242,.9);
      background:#fff;
      font-size:15px;
      outline:none;
      font-family:'Fredoka', sans-serif;
      color: var(--ink);
      margin-bottom:10px;
    }
    .rsvp textarea{
      resize: vertical;
      min-height: 92px;
      line-height: 1.2;
    }
    .rsvp input:focus, .rsvp select:focus, .rsvp textarea:focus{border-color: var(--hk-red);}

    /* Runner game */
    .runner{
      height: 260px;
      border-radius: 18px;
      background: linear-gradient(180deg, rgba(255,255,255,.85), rgba(255,255,255,.95));
      border: 2px solid rgba(255,255,255,.95);
      position:relative;
      overflow:hidden;
      user-select:none;
      touch-action: manipulation;
    }
    .ground{
      position:absolute;
      left:0; right:0;
      bottom:40px;
      height:4px;
      background: rgba(255,51,102,.22);
    }

    .player{
      position:absolute;
      left:28px;
      bottom:40px;
      width:90px;
      height:90px;
      will-change: transform;
      display:block;
    }
    .player img{
      width:100%;
      height:100%;
      object-fit:contain;
      display:block;
      filter: drop-shadow(0 10px 14px rgba(0,0,0,.14));
    }

    .obstacle{
      position:absolute;
      bottom:40px;
      width:52px;
      height:52px;
      will-change:left;
      display:block;
    }
    .obstacle img{
      width:100%;
      height:100%;
      object-fit:contain;
      display:block;
      filter: drop-shadow(0 10px 14px rgba(0,0,0,.14));
    }

    .hint{
      position:absolute;
      inset:0;
      display:grid;
      place-items:center;
      pointer-events:none;
    }
    .hint span{
      background: rgba(255,255,255,.88);
      border:2px solid rgba(255,230,242,.9);
      padding:12px 16px;
      border-radius: 999px;
      font-weight:900;
      color: var(--ink);
      box-shadow: 0 14px 22px rgba(0,0,0,.06);
    }

    .runnerHud{
      display:flex;
      justify-content:space-between;
      align-items:center;
      margin-top:12px;
      gap:10px;
    }
    .hudBox{
      background:#fff;
      border:2px solid rgba(255,230,242,.9);
      border-radius: 14px;
      padding:8px 10px;
      font-weight:900;
      font-size:13px;
      color: var(--hk-red);
      flex:1;
      text-align:center;
      box-shadow: 0 8px 14px rgba(0,0,0,.05);
    }

    .jumpBtn{
      position:absolute;
      right:12px;
      bottom:12px;
      width:78px;
      height:78px;
      border-radius:50%;
      border:none;
      background: var(--hk-red);
      color:#fff;
      font-weight:900;
      font-size:14px;
      box-shadow: 0 10px 22px rgba(255,51,102,.45);
      cursor:pointer;
      display:grid;
      place-items:center;
      z-index:5;
      touch-action: manipulation;
    }
    .jumpBtn:active{ transform: scale(0.97); }

    .confetti{
      position: fixed;
      top: -10px;
      width: 8px; height: 8px;
      background: #f00;
      animation: fall linear forwards;
      z-index: 3000;
      border-radius: 2px;
    }
    @keyframes fall{ to{ transform: translateY(110vh) rotate(720deg);} }

    /* ====== FIX: transici√≥n puesta en .cover (no s√≥lo en .hidden) ====== */
    .cover{
      position:fixed;
      inset:0;
      z-index:2500;
      display:grid;
      place-items:center;
      padding:18px;
      background: rgba(255, 230, 242, .92);
      backdrop-filter: blur(10px);

      transition: opacity .35s ease, transform .35s ease;
      opacity: 1;
      transform: translateY(0);
    }
    .cover.hidden{
      opacity:0;
      pointer-events:none;
      transform: translateY(10px);
    }

    .coverBox{
      width:min(520px, 100%);
      border-radius: 30px;
      overflow:hidden;
      border:2px solid rgba(255,255,255,.95);
      box-shadow: 0 20px 60px rgba(255, 51, 102, 0.22);
      position:relative;
      background:#fff;
    }
    .coverBg{
      width:100%;
      height: 72vh;
      min-height: 520px;
      background-image: url("img/portada-kitty.jpg");
      background-size: cover;
      background-position: center;
      position:relative;
    }
    .coverGlow{
      position:absolute;
      inset:0;
      background:
        radial-gradient(circle at 50% 18%, rgba(255,255,255,.55), transparent 55%),
        linear-gradient(180deg, transparent 35%, rgba(0,0,0,.22) 100%);
      pointer-events:none;
      filter: blur(1.5px);
    }

    /* ====== Portada: caja timeline + CTA integrado ====== */
    .coverMemoriesBox{
      position:absolute;
      inset: 14px;
      border-radius: 34px;
      overflow:hidden;
      background: rgba(255,255,255,.55);
      border:2px solid rgba(255,255,255,.95);
      box-shadow: 0 18px 36px rgba(0,0,0,.18);
      backdrop-filter: blur(12px);
      padding: 16px; /* Un poco m√°s de padding interno */
      display:flex;
      align-items:center;
      justify-content:flex-start;
    }

    /* ====== SOLUCI√ìN FINAL: 3 filas de 2 fotos + 1 fila bot√≥n ====== */
    .coverMemoriesBox .memories.timeline6{
      margin:0;
      width:100%;
      height:100%;
      display:grid;
      /* 2 columnas */
      grid-template-columns: repeat(2, 1fr); 
      /* 3 filas iguales para las fotos, 1 autom√°tica al final para el bot√≥n */
      grid-template-rows: 1fr 1fr 1fr auto;
      gap: 12px; /* Espacio bien definido entre elementos */
      align-items: stretch;
    }

    .coverMemoriesBox .memory{
      border-radius:22px;
      border:2px solid rgba(255,255,255,.95);
      box-shadow: 0 12px 18px rgba(0,0,0,.10);
      background: rgba(255,255,255,.55);
      /* Asegura que intenten ser cuadradas dentro de su fila */
      aspect-ratio: 1 / 1; 
    }

    .coverMemoriesBox .memory .badge{
      top:6px;
      left:6px;
      font-size:11px;
      padding:3px 7px;
      border-radius:999px;
    }

    .coverCta{
      /* Ocupa las 2 columnas */
      grid-column: 1 / -1;
      border:2px solid rgba(255,255,255,.95);
      background: radial-gradient(circle at 25% 0%, rgba(255,133,179,.35), transparent 55%),
                  linear-gradient(180deg, rgba(255,255,255,.92), rgba(255,255,255,.80));
      border-radius: 24px;
      box-shadow: 0 14px 22px rgba(0,0,0,.12);
      padding: 12px;
      text-align:center;
      cursor:pointer;
      display:grid;
      gap:6px;
      place-items:center;
      position:relative;
      overflow:hidden;
      font-family:'Fredoka', sans-serif;
      /* Se alinea al final de su celda (abajo) */
      align-self: end; 
      margin-top: 4px;
    }

    .coverCta::before{
      content:"";
      position:absolute;
      inset:-40px;
      background:
        radial-gradient(circle at 20% 20%, rgba(255,51,102,.18), transparent 55%),
        radial-gradient(circle at 85% 55%, rgba(255,133,179,.20), transparent 60%);
      filter: blur(10px);
      pointer-events:none;
    }

    .coverCtaTitle{
      position:relative;
      font-weight: 900;
      font-size: 20px;
      color: var(--hk-red);
      text-shadow: 2px 2px 0 #fff;
      line-height: 1.05;
    }

    .coverCtaSub{
      position:relative;
      font-weight: 800;
      font-size: 13px;
      color: var(--muted);
    }

    .coverCtaPill{
      position:relative;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      padding: 8px 14px;
      border-radius: 999px;
      background: var(--hk-red);
      color:#fff;
      font-weight: 900;
      font-size: 13px;
      box-shadow: 0 12px 22px rgba(255,51,102,.35);
    }

    .coverCta:active{ transform: scale(0.99); }

    /* ====== Importante: sacamos el bloque duplicado de texto/bot√≥n de portada ====== */
    .coverText, .coverBtnWrap{ display:none; }

    .footerPillWrap{
      display:flex;
      justify-content:center;
      margin-top:18px;
      padding-bottom: 6px;
    }
    .footerPill{
      background: rgba(255,255,255,.88);
      border: 2px solid rgba(255,133,179,.55);
      padding: 10px 14px;
      border-radius: 999px;
      font-weight:900;
      color: var(--hk-red);
      font-size: 14px;
      box-shadow: 0 16px 26px rgba(0,0,0,.06);
      text-shadow: 1px 1px 0 rgba(255,255,255,.9);
    }

    @media (max-width: 380px){
      .sticker{ width:98px; }
      .hk-real{ width:150px; height:150px; }
      .player{ width:84px; height:84px; }
      .obstacle{ width:48px; height:48px; }
      .jumpBtn{ width:70px; height:70px; }
      .mapKitty{ top:118px; width:140px; right:-22px; }

      .coverMemoriesBox{
        inset: 12px;
        padding: 12px;
      }
      .coverMemoriesBox .memories.timeline6{ gap:10px; }
      .coverCta{ padding: 10px; }
      .coverCtaTitle{ font-size: 18px; }
    }
  </style>
</head>

<body>

  <div class="cover" id="cover">
    <div class="coverBox">
      <div class="coverBg">
        <div class="coverGlow"></div>

        <div class="coverMemoriesBox" aria-label="Vicky de 0 a 5 a√±os">
          <div class="memories timeline6">
            <div class="memory"><span class="badge">0</span><img src="img/vicky-0.jpg" alt="Vicky 0 a√±os" onerror="this.style.display='none'"></div>
            <div class="memory"><span class="badge">1</span><img src="img/vicky-1.jpg" alt="Vicky 1 a√±o" onerror="this.style.display='none'"></div>
            <div class="memory"><span class="badge">2</span><img src="img/vicky-2.jpg" alt="Vicky 2 a√±os" onerror="this.style.display='none'"></div>
            <div class="memory"><span class="badge">3</span><img src="img/vicky-3.jpg" alt="Vicky 3 a√±os" onerror="this.style.display='none'"></div>
            <div class="memory"><span class="badge">4</span><img src="img/vicky-4.jpg" alt="Vicky 4 a√±os" onerror="this.style.display='none'"></div>
            <div class="memory"><span class="badge">5</span><img src="img/vicky-5.jpg" alt="Vicky 5 a√±os" onerror="this.style.display='none'"></div>

            <button class="coverCta" id="coverCtaBtn" type="button" aria-label="Entrar a la invitaci√≥n">
              <div class="coverCtaTitle">¬°Cumple de Vicky! üéÄ</div>
              <div class="coverCtaSub">Entr√° a la invitaci√≥n</div>
              <div class="coverCtaPill">üéâ Entrar</div>
            </button>
          </div>
        </div>
      </div>

      <div class="coverText">
        <h1 class="coverTitle">¬°Cumple de Victoria! üéÄ</h1>
        <p class="coverSub">Entr√° a la invitaci√≥n y confirm√° por WhatsApp</p>
      </div>
      <div class="coverBtnWrap">
        <button class="btn primary" id="btnEnter" type="button">üéâ Entrar a la invitaci√≥n</button>
      </div>
    </div>
  </div>

  <div class="wrap">
    <button class="backBtn" id="btnBack" type="button">‚¨ÖÔ∏è Volver a la portada</button>

    <div class="hk-header" aria-hidden="true">
      <div class="hk-real">
        <img src="img/kitty-head.png" alt="Hello Kitty" onerror="this.style.display='none'">
      </div>
    </div>

    <div class="card" style="padding-top:74px; text-align:center;">
      <img class="sticker st3 front" src="img/sticker-kitty-3.png" alt="" onerror="this.style.display='none'">
      <img class="sticker st1" src="img/sticker-kitty-5.png" alt="" onerror="this.style.display='none'">

      <h1 class="h1">¬° Victoria cumple 6 !</h1>
      <p class="sub">Vicky te invita a festejar su cumple! üéÄ</p>
      <div class="pill">Tem√°tica: Hello Kitty</div>
    </div>

    <div class="card">
      <img class="sticker st1 front" src="img/sticker-kitty-1.png" alt="" onerror="this.style.display='none'">
      <img class="sticker mapKitty front" src="img/sticker-kitty-2.png" alt="" onerror="this.style.display='none'">

      <h3 class="sectionTitle">Detalles del cumple üéâ</h3>

      <div class="info">
        <div class="icon">üìÖ</div>
        <div><b>D√≠a</b><span id="dateText">...</span></div>
      </div>

      <div class="info">
        <div class="icon">‚è∞</div>
        <div><b>Horario</b><span id="timeText">...</span></div>
      </div>

      <div class="info">
        <div class="icon">üìç</div>
        <div><b>Lugar</b><span id="placeText">...</span></div>
      </div>

      <div class="actions">
        <a class="btn secondary" id="btnMaps" href="#" target="_blank" rel="noopener">üó∫Ô∏è Ver Mapa</a>
      </div>
    </div>

    <div class="card">
      <img class="sticker st3 front" src="img/sticker-kitty-3.png" alt="" onerror="this.style.display='none'">

      <h3 class="sectionTitle" style="margin-bottom:10px;">Importante üí°</h3>

      <div class="info">
        <div class="icon">üç∞</div>
        <div>
          <b>Comidas y Bebidas</b>
          <span>
            Habr√° hamburguesas, snacks, torta y dulces.<br>
            Jugos, gaseosas y agua.
          </span>
        </div>
      </div>

      <div class="info">
        <div class="icon">‚ö†Ô∏è</div>
        <div><b>Alergias / cuidados</b><span>Si el ni√±o/a tiene alergias o alg√∫n cuidado especial, avis√° por ac√°.</span></div>
      </div>

      <div class="info">
        <div class="icon">üëï</div>
        <div><b>Ropa</b><span>Venir con ropa c√≥moda para jugar.</span></div>
      </div>
    </div>

    <div class="card">
      <img class="sticker st1 front" src="img/sticker-kitty-4.png" alt="" onerror="this.style.display='none'">

      <h3 style="margin:0 0 4px; color:var(--hk-red); font-weight:900;">Confirmar Asistencia</h3>
      <p style="font-size:13px; color:var(--muted); margin-bottom:14px; font-weight:700;">Por favor confirm√° para organizarnos mejor.</p>

      <div class="rsvp">
        <select id="answer">
          <option value="S√≠">‚úÖ ¬°Siii, voy!</option>
          <option value="No">‚ùå No podr√© ir</option>
        </select>

        <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px;" id="countsRow">
          <select id="guests">
            <option value="0">0 Adultos</option>
            <option value="1">1 Adulto</option>
            <option value="2">2 Adultos</option>
            <option value="3">3 Adultos</option>
            <option value="4">4 Adultos</option>
          </select>
          <select id="kids">
            <option value="0">0 Ni√±os</option>
            <option value="1">1 Ni√±o</option>
            <option value="2">2 Ni√±os</option>
            <option value="3">3 Ni√±os</option>
          </select>
        </div>

        <div id="namesWrap" style="margin-top:10px;"></div>

        <textarea id="notes" placeholder="Alergias / cuidados / observaciones (opcional)"></textarea>
      </div>

      <button class="btn primary" id="btnSend">üíñ Enviar Confirmaci√≥n por WhatsApp</button>
      <p id="note" style="margin:10px 0 0; font-size:12px; color:var(--muted); text-align:center; font-weight:700;"></p>
    </div>

    <div class="card">
      <img class="sticker st1 front" src="img/sticker-kitty-2.png" alt="" onerror="this.style.display='none'">
      <img class="sticker st4 front" src="img/sticker-kitty-5.png" alt="" onerror="this.style.display='none'">

      <h3 style="margin:0 0 4px; color:var(--hk-red); font-weight:900;">Juego: Junt√° los mo√±os üéÄ</h3>
      <p style="font-size:13px; color:var(--muted); margin-bottom:14px; font-weight:700;">
        Salt√° para <b>juntar mo√±os</b> üéÄ y esquivar las caquitas üí©.
      </p>

      <div class="runner" id="runner">
        <div class="hint" id="runnerHint"><span>Toc√° para saltar üëá</span></div>

        <div class="player" id="player">
          <img id="playerImg" src="img/game-kitty.png" alt="Kitty" onerror="this.style.display='none'">
        </div>

        <div class="ground"></div>

        <button class="jumpBtn" id="jumpBtn">Saltar</button>
      </div>

      <div class="runnerHud">
        <div class="hudBox">Mo√±os: <span id="runScore">0</span></div>
      </div>
      <p id="runMsg" style="margin:10px 0 0; font-size:12px; color:var(--muted); text-align:center; font-weight:700;"></p>
    </div>

    <div class="footerPillWrap">
      <div class="footerPill">Hecho por papi para Vicky üòç</div>
    </div>

  </div>

<script>
  const config = {
    cumpleNombre: "Victoria",
    cumpleEdad: 6,
    startISO: "2026-02-07T19:00:00-03:00",
    endISO:   "2026-02-07T23:00:00-03:00",
    lugarNombre: "Complejo HM",
    mapsUrl: "https://maps.app.goo.gl/Z7a8qiCnV5MK5B4t7?g_st=ic",
    whatsappNumber: "+5555999513169",

    img: {
      good: [
        { src: "img/game-bow.png", alt: "mo√±o", kind: "bow" }
      ],
      bad: [
        { src: "img/game-poop-red.png",   alt: "caquita roja",   kind: "poop-red" },
        { src: "img/game-poop-green.png", alt: "caquita verde",  kind: "poop-green" },
        { src: "img/game-poop-brown.png", alt: "caquita marr√≥n", kind: "poop-brown" }
      ]
    }
  };

  // ====== AUDIO FIX: lazy init + unlock seguro (iOS/Safari) ======
  let audioCtx = null;
  let soundBuffers = {};
  let audioUnlocked = false;

  function getAudioCtx(){
    if(!audioCtx){
      const AudioContext = window.AudioContext || window.webkitAudioContext;
      audioCtx = new AudioContext();
    }
    return audioCtx;
  }

  async function loadSound(key, url) {
    try {
      const ctx = getAudioCtx();
      const response = await fetch(url);
      if(!response.ok) throw new Error("File not found");
      const arrayBuffer = await response.arrayBuffer();
      soundBuffers[key] = await ctx.decodeAudioData(arrayBuffer);
    } catch (e) {
      console.warn("Error cargando sonido:", url);
    }
  }

  loadSound("bow",  "audio/bow.mp3");
  loadSound("fart", "audio/fart.mp3");
  loadSound("jump", "audio/jump.mp3");

  function unlockAudio(){
    if(audioUnlocked) return;
    const ctx = getAudioCtx();
    if (ctx.state === 'suspended') ctx.resume().catch(()=>{});
    audioUnlocked = true;

    const buffer = ctx.createBuffer(1, 1, 22050);
    const source = ctx.createBufferSource();
    source.buffer = buffer;
    source.connect(ctx.destination);
    source.start(0);
  }

  function playSfx(name){
    if(!audioUnlocked || !soundBuffers[name]) return;
    const ctx = getAudioCtx();

    const source = ctx.createBufferSource();
    source.buffer = soundBuffers[name];

    const gainNode = ctx.createGain();
    if(name === "bow")  gainNode.gain.value = 0.45;
    if(name === "jump") gainNode.gain.value = 0.85;
    if(name === "fart") gainNode.gain.value = 0.60;

    source.connect(gainNode);
    gainNode.connect(ctx.destination);
    source.start(0);
  }

  function triggerConfetti(){
    for(let i=0; i<28; i++){
      const c = document.createElement("div");
      c.className = "confetti";
      c.style.left = Math.random()*100 + "vw";
      c.style.background = (Math.random() > 0.5) ? "var(--hk-red)" : "#ffd700";
      c.style.animationDuration = (2 + Math.random()*2.5) + "s";
      document.body.appendChild(c);
      setTimeout(()=>c.remove(), 4500);
    }
  }

  // Portada
  const cover = document.getElementById("cover");
  const btnBack = document.getElementById("btnBack");
  const btnEnter = document.getElementById("btnEnter");
  const coverCtaBtn = document.getElementById("coverCtaBtn");

  function enterInvite(){
    unlockAudio();
    triggerConfetti();
    cover.classList.add("hidden");
    btnBack.style.display = "inline-flex";
    setTimeout(()=>{ cover.style.display = "none"; }, 420);
    window.scrollTo(0,0);
  }

  if(btnEnter) btnEnter.addEventListener("click", enterInvite);
  if(coverCtaBtn) coverCtaBtn.addEventListener("click", enterInvite);

  // Fecha/Hora/Lugar
  const start = new Date(config.startISO);
  const end = new Date(config.endISO);

  const fmtDate = new Intl.DateTimeFormat("es-UY", {
    weekday:"long", day:"numeric", month:"long", year:"numeric"
  });
  const fmtTime = new Intl.DateTimeFormat("es-UY", {
    hour: "2-digit", minute: "2-digit", hour12: false
  });

  const dateStr = fmtDate.format(start);
  document.getElementById("dateText").textContent = dateStr.charAt(0).toUpperCase() + dateStr.slice(1);
  document.getElementById("timeText").textContent = `${fmtTime.format(start)} a ${fmtTime.format(end)} hs`;
  document.getElementById("placeText").textContent = config.lugarNombre;
  document.getElementById("btnMaps").href = config.mapsUrl;

  // ====== Inputs din√°micos de nombres + "quien confirma" ======
  const guestsEl = document.getElementById("guests");
  const kidsEl   = document.getElementById("kids");
  const answerEl = document.getElementById("answer");
  const namesWrap = document.getElementById("namesWrap");
  const countsRow = document.getElementById("countsRow");

  function styleLikeInputs(container){
    container.querySelectorAll("input").forEach(inp=>{
      inp.style.width = "100%";
      inp.style.padding = "14px";
      inp.style.borderRadius = "16px";
      inp.style.border = "2px solid rgba(255,230,242,.9)";
      inp.style.background = "#fff";
      inp.style.fontSize = "15px";
      inp.style.outline = "none";
      inp.style.fontFamily = "'Fredoka', sans-serif";
      inp.style.color = "var(--ink)";
      inp.style.marginBottom = "10px";
    });
  }

  function buildNameInputs(){
    const answer = answerEl.value;
    const adults = parseInt(guestsEl.value, 10) || 0;
    const kids   = parseInt(kidsEl.value, 10) || 0;

    const parts = [];

    if(answer !== "S√≠"){
      parts.push(`<div style="font-weight:800; color:var(--hk-red); margin:6px 0 6px;">¬øQui√©n confirma?</div>`);
      parts.push(`<input class="rsvpName" data-type="confirmer" placeholder="Nombre" />`);
      namesWrap.innerHTML = parts.join("");
      styleLikeInputs(namesWrap);
      return;
    }

    if(adults === 0){
      parts.push(`<div style="font-weight:800; color:var(--hk-red); margin:6px 0 6px;">Adulto responsable (quien confirma)</div>`);
      parts.push(`<input class="rsvpName" data-type="resp" placeholder="Nombre" />`);
    }

    if(adults > 0){
      parts.push(`<div style="font-weight:800; color:var(--hk-red); margin:6px 0 6px;">Nombres de adultos</div>`);
      for(let i=1; i<=adults; i++){
        parts.push(`<input class="rsvpName" data-type="adult" data-index="${i}" placeholder="Adulto ${i}: nombre" />`);
      }
    }

    if(kids > 0){
      parts.push(`<div style="font-weight:800; color:var(--hk-red); margin:10px 0 6px;">Nombres de ni√±os</div>`);
      for(let i=1; i<=kids; i++){
        parts.push(`<input class="rsvpName" data-type="kid" data-index="${i}" placeholder="Ni√±o ${i}: nombre" />`);
      }
    }

    namesWrap.innerHTML = parts.join("");
    styleLikeInputs(namesWrap);
  }

  function toggleCountsRow(){
    const answer = answerEl.value;

    if(answer !== "S√≠"){
      countsRow.style.display = "none";
      guestsEl.value = "0";
      kidsEl.value = "0";
    } else {
      countsRow.style.display = "grid";
    }
    buildNameInputs();
  }

  guestsEl.addEventListener("change", buildNameInputs);
  kidsEl.addEventListener("change", buildNameInputs);
  answerEl.addEventListener("change", toggleCountsRow);

  toggleCountsRow();

  // WhatsApp
  function sendWsp(){
    const answer = answerEl.value;

    const guests = (answer === "S√≠") ? (parseInt(guestsEl.value, 10) || 0) : 0;
    const kids   = (answer === "S√≠") ? (parseInt(kidsEl.value, 10) || 0) : 0;

    const noteEl = document.getElementById("note");
    const notes = (document.getElementById("notes").value || "").trim();

    const inputs = Array.from(document.querySelectorAll(".rsvpName"));

    const adultsInputs = inputs.filter(i => i.dataset.type === "adult");
    const kidsInputs   = inputs.filter(i => i.dataset.type === "kid");
    const respInput    = inputs.find(i => i.dataset.type === "resp");
    const confirmerInp = inputs.find(i => i.dataset.type === "confirmer");

    const adultNames = adultsInputs.map(i => (i.value || "").trim());
    const kidNames   = kidsInputs.map(i => (i.value || "").trim());

    if(answer === "S√≠"){
      if((guests + kids) <= 0){
        noteEl.textContent = "Si vas a venir, seleccion√° al menos 1 adulto o 1 ni√±o üôÇ";
        return;
      }

      if(guests === 0){
        const respName = (respInput?.value || "").trim();
        if(!respName){
          noteEl.textContent = "Escrib√≠ el nombre del adulto responsable üôÇ";
          respInput && respInput.focus();
          return;
        }
      }

      const missingAdult = adultNames.some(v => !v);
      const missingKid   = kidNames.some(v => !v);

      if((adultsInputs.length && missingAdult) || (kidsInputs.length && missingKid)){
        noteEl.textContent = "Complet√° los nombres de todos los adultos y ni√±os üôÇ";
        const firstEmpty = [...adultsInputs, ...kidsInputs].find(i => !(i.value || "").trim());
        if(firstEmpty) firstEmpty.focus();
        return;
      }
    } else {
      const confName = (confirmerInp?.value || "").trim();
      if(!confName){
        noteEl.textContent = "Escrib√≠ tu nombre para confirmar üôÇ";
        confirmerInp && confirmerInp.focus();
        return;
      }
    }

    noteEl.textContent = "";

    let confirmerName = "";
    if(answer === "S√≠"){
      if(guests > 0) confirmerName = adultNames[0] || "";
      else confirmerName = (respInput?.value || "").trim();
    } else {
      confirmerName = (confirmerInp?.value || "").trim();
    }

    let namesBlock = "";
    if(answer === "S√≠"){
      if(guests > 0 && adultNames.length){
        namesBlock += `\nüë®‚Äçüë©‚Äçüëß Adultos:\n- ${adultNames.join("\n- ")}\n`;
      }
      if(kids > 0 && kidNames.length){
        namesBlock += `\nüßí Ni√±os:\n- ${kidNames.join("\n- ")}\n`;
      }
      if(guests === 0){
        namesBlock = `\nüë§ Adulto responsable: ${confirmerName}\n` + namesBlock;
      }
    }

    const obsBlock = notes ? `\nüìù Observaciones: ${notes}\n` : "";

    const text =
`*CONFIRMACI√ìN CUMPLE ${config.cumpleNombre.toUpperCase()} (${config.cumpleEdad})* üéÄ
üë§ Confirma: ${confirmerName}
üíå Asiste: ${answer}
Adultos: ${guests} | Ni√±os: ${kids}${namesBlock}${obsBlock}

üìÖ ${dateStr.charAt(0).toUpperCase() + dateStr.slice(1)}
‚è∞ ${fmtTime.format(start)} a ${fmtTime.format(end)} hs
üìç ${config.lugarNombre}
üó∫Ô∏è ${config.mapsUrl}

¬°Gracias!`;

    triggerConfetti();
    const phoneDigits = String(config.whatsappNumber).replace(/\D/g, "");
    const url = `https://wa.me/${phoneDigits}?text=${encodeURIComponent(text)}`;
    window.open(url, "_blank");
  }
  document.getElementById("btnSend").addEventListener("click", sendWsp);

  // Runner Game
  const runner = document.getElementById("runner");
  const playerEl = document.getElementById("player");
  const hintEl = document.getElementById("runnerHint");
  const runScoreEl = document.getElementById("runScore");
  const runMsg = document.getElementById("runMsg");
  const jumpBtn = document.getElementById("jumpBtn");

  let playing = false;
  let score = 0;

  let y = 0;
  let vy = 0;
  const GRAVITY = -0.8;
  const JUMP_V = 16;

  const PLAYER_LEFT = 28;
  const PLAYER_W = 90;
  const PLAYER_H = 90;
  const GROUND_Y = 40;

  let obstacles = [];
  let speed = 4.2;
  let spawnCooldown = 0;

  const OB_W = 52;
  const OB_H = 52;

  const OB_HIT_W = 26;
  const OB_HIT_H = 22;

  const P_HIT_W = 34;
  const P_HIT_H = 40;

  function resetGame(){
    obstacles.forEach(o => o.el.remove());
    obstacles = [];
    score = 0;
    speed = 4.2;
    spawnCooldown = 0;
    y = 0;
    vy = 0;
    runScoreEl.textContent = "0";
    runMsg.textContent = "";
    hintEl.style.display = "grid";
    setPlayerY();
  }

  function setPlayerY(){
    playerEl.style.transform = `translateY(${(-y)}px)`;
  }

  function ensureStart(){
    if(!playing){
      resetGame();
      playing = true;
      requestAnimationFrame(loop);
    }
  }

  function jump(){
    ensureStart();
    if(y <= 0.01){
      y = 0;
      vy = JUMP_V;
      playSfx("jump");
      hintEl.style.display = "none";
    }
  }

  function spawnObstacle(){
    const el = document.createElement("div");
    el.className = "obstacle";

    const isGood = Math.random() < 0.55;
    const pool = isGood ? config.img.good : config.img.bad;
    const pick = pool[Math.floor(Math.random() * pool.length)];

    el.dataset.type = isGood ? "good" : "bad";
    el.dataset.kind = pick.kind;

    const img = document.createElement("img");
    img.src = pick.src;
    img.alt = pick.alt;
    img.onerror = ()=>{ img.style.display = "none"; };

    el.appendChild(img);
    runner.appendChild(el);

    const runnerW = runner.getBoundingClientRect().width;

    const obs = {
      el,
      x: runnerW + 60,
      w: OB_W,
      h: OB_H,
      type: isGood ? "good" : "bad",
      kind: pick.kind
    };

    obstacles.push(obs);
    el.style.left = obs.x + "px";
  }

  function aabb(px1, py1, pw, ph, ox1, oy1, ow, oh){
    const px2 = px1 + pw, py2 = py1 + ph;
    const ox2 = ox1 + ow, oy2 = oy1 + oh;
    return (px1 < ox2 && px2 > ox1 && py1 < oy2 && py2 > oy1);
  }

  function collisionCheck(){
    const px = PLAYER_LEFT + (PLAYER_W - P_HIT_W) / 2;
    const py = (GROUND_Y + y) + (PLAYER_H - P_HIT_H) - 6;

    for(const o of obstacles){
      const ox = o.x + (o.w - OB_HIT_W) / 2;
      const oy = GROUND_Y + (o.h - OB_HIT_H);

      if(aabb(px, py, P_HIT_W, P_HIT_H, ox, oy, OB_HIT_W, OB_HIT_H)) {
        return o;
      }
    }
    return null;
  }

  function loop(){
    if(!playing) return;

    vy += GRAVITY;
    y += vy;
    if(y < 0){ y = 0; vy = 0; }
    setPlayerY();

    for(const o of obstacles){
      o.x -= speed;
      o.el.style.left = o.x + "px";
    }

    obstacles = obstacles.filter(o => {
      if(o.x < -90){
        o.el.remove();
        return false;
      }
      return true;
    });

    spawnCooldown -= 1;
    if(spawnCooldown <= 0){
      spawnObstacle();
      spawnCooldown = 58 + Math.floor(Math.random() * 36);
      if(speed < 7.5) speed += 0.03;
    }

    const hit = collisionCheck();
    if(hit){
      if(hit.type === "good"){
        playSfx("bow");
        score += 1;
        runScoreEl.textContent = String(score);
        hit.el.remove();
        obstacles = obstacles.filter(o => o !== hit);
        runMsg.textContent = `¬°Bien! +1 mo√±o üéÄ (Total: ${score})`;
      } else {
        playSfx("fart");
        playing = false;
        runMsg.textContent = `¬°Nooo! üí© Te chocaste. Mo√±os juntados: ${score}.`;
        hintEl.style.display = "grid";
        return;
      }
    }

    requestAnimationFrame(loop);
  }

  runner.addEventListener("pointerdown", (e)=>{
    unlockAudio();
    if(e.target && e.target.id === "jumpBtn") return;
    jump();
  });
  jumpBtn.addEventListener("pointerdown", (e)=>{ unlockAudio(); e.preventDefault(); jump(); });
  document.addEventListener("keydown", (e)=>{ if(e.code === "Space") jump(); });

  resetGame();

  // BOT√ìN VOLVER
  btnBack.addEventListener("click", ()=>{
    cover.style.display = "grid";
    void cover.offsetWidth;
    cover.classList.remove("hidden");
    btnBack.style.display = "none";
    playing = false;
    window.scrollTo(0,0);
  });
</script>
</body>
</html>
